{% extends "base.html" %}

{% block title %}ZyRace â€” Documentation | Developer Guide, API & Mechanics{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
<style>
  .docs-nav {
    background: var(--white);
    border-radius: var(--border-radius);
    padding: 1rem;
    margin: 2rem 0;
    box-shadow: var(--light-shadow);
  }

  .docs-nav ul {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 1rem;
    list-style: none;
    padding: 0;
  }

  .docs-nav a {
    padding: 0.5rem 1rem;
    background: rgba(255, 140, 0, 0.1);
    border-radius: 20px;
    transition: var(--transition);
    color: var(--primary);
    text-decoration: none;
    font-weight: 600;
  }

  .docs-nav a:hover {
    background: var(--primary);
    color: white;
  }

  .code-block {
    background: #2d3748;
    border-radius: 10px;
    padding: 1.5rem;
    margin: 1.5rem 0;
    overflow-x: auto;
    position: relative;
  }

  .code-block pre {
    margin: 0;
    font-family: 'Roboto Mono', monospace;
    font-size: 0.9rem;
    line-height: 1.4;
    color: #e2e8f0;
  }

  .code-block .copy-btn {
    position: absolute;
    top: 0.5rem;
    right: 0.5rem;
    background: var(--primary);
    color: white;
    border: none;
    padding: 0.5rem;
    border-radius: 5px;
    cursor: pointer;
    font-size: 0.8rem;
  }

  .api-table {
    width: 100%;
    border-collapse: collapse;
    margin: 1rem 0;
  }

  .api-table th,
  .api-table td {
    padding: 1rem;
    border: 1px solid #e2e8f0;
    text-align: left;
  }

  .api-table th {
    background: rgba(255, 140, 0, 0.1);
    font-weight: 600;
    color: var(--primary);
  }

  .api-table code {
    background: rgba(0, 0, 0, 0.1);
    padding: 0.2rem 0.4rem;
    border-radius: 3px;
    font-family: 'Roboto Mono', monospace;
  }
</style>
{% endblock %}

{% block content %}
<section class="hero visible" id="hero">
  <div class="container">
    <div class="logo-container">
      <h1 class="logo">Documen<span style="color:var(--yellow);">tation</span></h1>
    </div>
    <p class="tagline">Under the hood of ZyRace. Mechanics, APIs, and Setup.</p>
    <div class="cta-container">
      <div class="main-cta">
        <a href="/" class="btn btn-primary"><i class="fas fa-home"></i> BACK TO HOME</a>
        <a href="https://github.com/ajmaluk" target="_blank" class="btn btn-secondary"><i class="fab fa-github"></i>
          GITHUB</a>
      </div>
    </div>
  </div>
</section>

<nav class="docs-nav container">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#architecture">Architecture</a></li>
    <li><a href="#physics">Physics Engine</a></li>
    <li><a href="#tuning-api">Tuning API</a></li>
    <li><a href="#backend">Backend Setup</a></li>
  </ul>
</nav>

<section class="section-container visible" id="overview">
  <h2 class="section-title">Project Overview</h2>
  <div class="container">
    <p>ZyRace is a free, browser-based car physics puzzle racing game built with HTML5, JavaScript (using Matter.js for
      physics), and a lightweight Python Flask backend hosted on PythonAnywhere.</p>
    <p><strong>Key Features:</strong></p>
    <ul style="list-style: disc; padding-left: 2rem; color: var(--light-text);">
      <li>Realistic 2D physics simulation using Matter.js.</li>
      <li>Modular car tuning system with JSON configs.</li>
      <li>Procedural track generation and hazard integration.</li>
      <li>Offline-capable via browser caching.</li>
    </ul>
  </div>
</section>

<section class="section-container visible" id="architecture">
  <h2 class="section-title">Game Architecture</h2>
  <div class="container">
    <p>ZyRace uses a client-server model with emphasis on client-side rendering for smooth performance.</p>
    <div class="code-block">
      <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      <pre><code class="language-javascript">// High-level game flow (conceptual example)
class GameEngine {
  constructor() {
    this.physics = Matter.Engine.create();
    this.renderer = new CanvasRenderer(this.physics.world);
    this.tuner = new CarTuner();
  }
  startLevel(trackData) {
    this.world = this.trackGen.build(trackData);
    this.car = this.tuner.assemble(this.carConfig);
    Matter.World.add(this.physics.world, [this.car.body, ...this.world.bodies]);
    this.simulate();
  }
}</code></pre>
    </div>
  </div>
</section>

<section class="section-container visible" id="physics">
  <h2 class="section-title">Physics Engine</h2>
  <div class="container">
    <p>Powered by Matter.js, ZyRace simulates realistic 2D rigid body dynamics: gravity, friction, and restitution.</p>
    <h3>Key Components</h3>
    <ul style="list-style: disc; padding-left: 2rem; color: var(--light-text);">
      <li><strong>Bodies:</strong> Chassis (rectangle), wheels (circles).</li>
      <li><strong>Constraints:</strong> Wheel joints with limits for suspension.</li>
      <li><strong>Forces:</strong> Thrust, drag, impulse.</li>
    </ul>
  </div>
</section>

<section class="section-container visible" id="tuning-api">
  <h2 class="section-title">Car Tuning API</h2>
  <div class="container">
    <p>The tuning system uses declarative JSON for vehicle configs.</p>
    <table class="api-table">
      <thead>
        <tr>
          <th>Property</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>chassis</code></td>
          <td>Object</td>
          <td>Base body specs (width, height, mass)</td>
        </tr>
        <tr>
          <td><code>parts</code></td>
          <td>Array</td>
          <td>Attached components (engine, boosters)</td>
        </tr>
        <tr>
          <td><code>wheels</code></td>
          <td>Array</td>
          <td>Wheel positions and grip</td>
        </tr>
      </tbody>
    </table>
    <div class="code-block">
      <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      <pre><code class="language-json">// Example Config
{
  "chassis": { "width": 120, "height": 50, "mass": 60 },
  "wheels": [
    { "x": -50, "y": 25, "radius": 15, "grip": 0.9 },
    { "x": 50, "y": 25, "radius": 15, "grip": 0.9 }
  ]
}</code></pre>
    </div>
  </div>
</section>

<section class="section-container visible" id="backend">
  <h2 class="section-title">Backend Setup</h2>
  <div class="container">
    <p>ZyRace's backend is built with Flask and hosted on PythonAnywhere.</p>
    <div class="code-block">
      <button class="copy-btn" onclick="copyCode(this)">Copy</button>
      <pre><code class="language-python"># app.py - Flask backend example
from flask import Flask, jsonify

app = Flask(__name__)

@app.route('/api/status')
def status():
    return jsonify({'status': 'online', 'version': '2.1.0'})

if __name__ == '__main__':
    app.run()</code></pre>
    </div>
  </div>
</section>

{% endblock %}

{% block scripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script>
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
      }
    });
  }, { threshold: 0.1 });
  document.querySelectorAll('section').forEach(section => observer.observe(section));

  function copyCode(btn) {
    const code = btn.nextElementSibling.innerText;
    navigator.clipboard.writeText(code).then(() => {
      btn.textContent = 'Copied!';
      setTimeout(() => btn.textContent = 'Copy', 2000);
    });
  }
</script>
{% endblock %}